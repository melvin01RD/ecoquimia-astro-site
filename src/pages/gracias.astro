---
import Base from "../layouts/Base.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { CheckCircle2, Mail, PhoneCall, ArrowLeft } from "@lucide/astro";

export const prerender = true;

const url = new URL(Astro.request.url);
const name = url.searchParams.get("name") ?? "";
const service = url.searchParams.get("service") ?? "";

// Ajusta el número y el correo del negocio
const WHATSAPP_NUMBER = "18095551234"; // sin símbolos
const MAIL_TO = "contacto@ecoquimia.com";

// Copys
const headline = `Hemos recibido tu solicitud${name ? `, ${name}` : ""}.`;
const sub = `Gracias por elegirnos${service ? ` para “${service}”` : ""}. Un asesor te contactará en un plazo no mayor a 1 día laborable.`;
---

<Base title="Gracias — Ecoquimia" description="Solicitud recibida">
  <Header slot="header" />

  <!-- fondo suave -->
  <section class="relative overflow-hidden pt-16 md:pt-20">
    <div class="absolute inset-0 -z-10 bg-[radial-gradient(70%_70%_at_50%_0%,rgba(16,185,129,.14),rgba(255,255,255,0))]"></div>

    <div class="container-max px-4 py-10 md:py-14">
      <div class="mx-auto max-w-3xl">
        <!-- card -->
        <div class="rounded-app border bg-white/90 backdrop-blur p-6 md:p-8 shadow-sm">
          <div class="flex items-start gap-4">
            <div class="shrink-0 rounded-full bg-emerald-100 p-2">
              <CheckCircle2 class="h-7 w-7 text-emerald-600" />
            </div>
            <div>
              <h1 class="text-2xl md:text-3xl font-bold tracking-tight text-zinc-900">
                {headline}
              </h1>
              <p class="mt-2 text-zinc-600">
                {sub}
              </p>
            </div>
          </div>

          <!-- importante -->
          <div class="mt-6 rounded-xl border bg-zinc-50 p-5">
            <h2 class="mb-2 text-lg font-semibold text-zinc-900">Importante</h2>
            <ul class="list-disc space-y-1 pl-6 text-zinc-700">
              <li>Revisa tu bandeja de entrada y la carpeta de spam.</li>
              <li>Ten a mano una breve descripción del servicio que necesitas.</li>
              <li>Si deseas agilizar, responde al correo de confirmación con fotos o detalles.</li>
            </ul>
          </div>

          <!-- CTAs -->
          <div class="mt-6 flex flex-col sm:flex-row gap-3">
            <a
              href={`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(
                `Hola Ecoquimia, hice una solicitud${service ? ` para “${service}”` : ""}${name ? ` a nombre de ${name}` : ""}.`
              )}`}
              class="inline-flex items-center justify-center gap-2 rounded-xl bg-emerald-600 px-4 py-2.5 text-white hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500"
            >
              <PhoneCall class="h-5 w-5" />
              Contactar por WhatsApp
            </a>

            <a
              href={`mailto:${MAIL_TO}?subject=${encodeURIComponent(
                `Seguimiento de solicitud${service ? `: ${service}` : ""}`
              )}&body=${encodeURIComponent(
                `Hola Ecoquimia,\n\nQuiero dar seguimiento a mi solicitud${service ? ` de ${service}` : ""}.${name ? `\nNombre: ${name}` : ""}\n\nGracias.`
              )}`}
              class="inline-flex items-center justify-center gap-2 rounded-xl border px-4 py-2.5 text-zinc-800 hover:bg-zinc-50 focus:outline-none focus:ring-2 focus:ring-emerald-500"
            >
              <Mail class="h-5 w-5" />
              Enviar correo
            </a>

            <a
              href="/"
              class="inline-flex items-center justify-center gap-2 rounded-xl border px-4 py-2.5 text-zinc-800 hover:bg-zinc-50 focus:outline-none focus:ring-2 focus:ring-emerald-500 sm:ml-auto"
            >
              <ArrowLeft class="h-5 w-5" />
              Volver al inicio
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <Footer slot="footer" />

  <!-- Analytics opcional -->
  <script is:inline>
    (window).dataLayer = (window).dataLayer || [];
    window.dataLayer.push({
      event: "quote_submitted",
      service: new URLSearchParams(location.search).get("service") || "",
    });
  </script>
</Base>